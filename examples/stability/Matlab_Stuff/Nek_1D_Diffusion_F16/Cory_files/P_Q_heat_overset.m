function [P_L,Q_L,S_L,D2_L,P_R,Q_R,S_R,D2_R] = P_Q_heat_overset(n_L,n_R,bndry_order,a_L,a_R)
P_L = zeros(n_L,n_L);
Q_L = zeros(n_L,n_L);
S_L = zeros(n_L,n_L);
D_L = zeros(n_L,n_L);
D2_L = zeros(n_L,n_L);

if bndry_order==1
    P_L(1,1) = 1/2;
    Q_L(1,1) = -1/2;
    Q_L(1,2) = 1/2;
    Q_L(n_L-1,n_L-2) = -1/2;

    %%%%% Q_L = [0.5 0;-0.5 0.5]
    P_L(n_L-1,n_L-1) = 1 - a_L^2/2;
    P_L(n_L,n_L) = ((1-a_L)^2)/2;
    Q_L(n_L-1,n_L-1) = a_L^2/2;
    Q_L(n_L-1,n_L) = 1/2 - a_L^2/2;
    Q_L(n_L,n_L-1) = -((1-a_L)^2)/2;
    Q_L(n_L,n_L) = ((1-a_L)^2)/2;
    
%     %%%%% Q_L = [0 0.5;-0.5 0.5]
%     P_L(n_L-1,n_L-1) = 1;
%     P_L(n_L,n_L) = 1/2;
%     Q_L(n_L-1,n_L) = 1/2;
%     Q_L(n_L,n_L-1) = -1/2;
%     Q_L(n_L,n_L) = 1/2;

    for i = 2:1:n_L-2
        Q_L(i,i-1) = -1/2;
        Q_L(i,i+1) = 1/2;
        P_L(i,i) = 1;
    end

    [D_L(1,1),D_L(n_L,n_L-1)] = deal(-1);
    [D_L(1,2),D_L(n_L,n_L)] = deal(1);
    [D2_L(1,1),D2_L(1,3),D2_L(n_L,n_L-2),D2_L(n_L,n_L)] = deal(1);
    [D2_L(1,2),D2_L(n_L,n_L-1)] = deal(-2);
    for i=2:n_L-1        
        D_L(i,i-1) = -1/2;
        D_L(i,i+1) = 1/2;
        [D2_L(i,i-1),D2_L(i,i+1)] = deal(1);
        D2_L(i,i) = -2;
    end
%     S_L = D_L;
    [S_L(1,1),S_L(n_L,n_L)] = deal(3/2);
    [S_L(1,2),S_L(n_L,n_L-1)] = deal(-2);
    [S_L(1,3),S_L(n_L,n_L-2)] = deal(1/2);
    S_L(1,1:n_L) = -1*S_L(1,1:n_L);
    S_L(n_L,n_L-2) = (1-2*a_L)/2;
    S_L(n_L,n_L-1) = -2*S_L(n_L,n_L-2)-1;
    S_L(n_L,n_L) = 1 + S_L(n_L,n_L-2);
%     disp('P=');disp(P);
%     disp('D=');disp(D);       
elseif bndry_order==2
    D_L(1,1) = -24/17;
    D_L(1,2) = 59/34;
    D_L(1,3) = -4/17;
    D_L(1,4) = -3/34;
    D_L(2,1) = -1/2;
    D_L(2,3) = 1/2;
    D_L(3,1) = 4/43;
    D_L(3,2) = -59/86;
    D_L(3,4) = 59/86;
    D_L(3,5) = -4/43;
    D_L(4,1) = 3/98;
    D_L(4,3) = -59/98;
    D_L(4,5) = 32/49;
    D_L(4,6) = -4/49;
%     D(1,1) = -1/2;
%     D(1,2) = 59/96;
%     D(1,3) = -1/12;
%     D(1,4) = -1/32;
%     D(2,1) = -59/96;
%     D(2,3) = 59/96;
%     D(3,1) = 1/12;
%     D(3,2) = -59/96;
%     D(3,4) = 59/96;
%     D(3,5) = -1/12;
%     D(4,1) = 1/32;
%     D(4,3) = -59/96;
%     D(4,5) = 2/3;
%     D(4,6) = -1/12;
    
    [P_L(1,1),P_L(n_L,n_L)] = deal(17/48);
    [P_L(2,2),P_L(n_L-1,n_L-1)] = deal(59/48);
    [P_L(3,3),P_L(n_L-2,n_L-2)] = deal(43/48);
    [P_L(4,4),P_L(n_L-3,n_L-3)] = deal(49/48);

    for i = 5:1:n_L-4
        P_L(i,i) = 1;
        D_L(i,i-2) = 1/12;
        D_L(i,i-1) = -2/3;
        D_L(i,i+1) = 2/3;
        D_L(i,i+2) = -1/12;
    end

    for i=1:1:4
        for j=1:1:6
            D_L(n_L+1-i,n_L+1-j) = -D_L(i,j);
        end
    end

    D2_L(1,1) = 2;
    D2_L(1,2) = -5;
    D2_L(1,3) = 4;
    D2_L(1,4) = -1;
    D2_L(2,1) = 1;
    D2_L(2,2) = -2;
    D2_L(2,3) = 1;
    D2_L(3,1) = -4/43;
    D2_L(3,2) = 59/43;
    D2_L(3,3) = -110/43;
    D2_L(3,4) = 59/43;
    D2_L(3,5) = -4/43;
    D2_L(4,1) = -1/49;
    D2_L(4,3) = 59/49;
    D2_L(4,4) = -118/49;
    D2_L(4,5) = 64/49;
    D2_L(4,6) = -4/49;

    for i = 5:1:n_L-4
        D2_L(i,i-2) = -1/12;
        D2_L(i,i-1) = 4/3;
        D2_L(i,i) = -5/2;
        D2_L(i,i+1) = 4/3;
        D2_L(i,i+2) = -1/12;
    end

    for i=1:1:4
        for j=1:1:6
            D2_L(n_L+1-i,n_L+1-j) = D2_L(i,j);
        end
    end
end
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
P_R = zeros(n_R,n_R);
Q_R = zeros(n_R,n_R);
S_R = zeros(n_R,n_R);
D_R = zeros(n_R,n_R);
D2_R = zeros(n_R,n_R);

if bndry_order==1
    beta_R = 0.5;
    %[-beta_R beta_R;-beta_R 0]
    P_R(1,1) = beta_R;
    P_R(2,2) = beta_R*2;
    Q_R(1,1) = -beta_R;
    Q_R(1,2) = beta_R;
    Q_R(2,1) = -beta_R;
    Q_R(2,2) = 0;
    Q_R(2,3) = beta_R;
    
    % [-beta_R beta_R;-beta_R beta_R]
%     P_R(1,1) = beta_R;
%     P_R(2,2) = beta_R;
%     Q_R(1,1) = -beta_R;
%     Q_R(1,2) = beta_R;
%     Q_R(2,1) = -beta_R;
%     Q_R(2,2) = beta_R;
%     Q_R(2,3) = 0;

    Q_R(n_R,n_R-1) = -beta_R;
    Q_R(n_R,n_R) = beta_R;
    P_R(n_R,n_R) = beta_R;

    for i = 3:1:n_R-1
        Q_R(i,i-1) = -beta_R;
        Q_R(i,i+1) = beta_R;
        P_R(i,i) = beta_R*2;
    end
           
    [D_R(1,1),D_R(n_R,n_R-1)] = deal(-1);
    [D_R(1,2),D_R(n_R,n_R)] = deal(1);
    [D2_R(1,1),D2_R(1,3),D2_R(n_R,n_R-2),D2_R(n_R,n_R)] = deal(1);
    [D2_R(1,2),D2_R(n_R,n_R-1)] = deal(-2);
    for i=2:n_R-1        
        D_R(i,i-1) = -1/2;
        D_R(i,i+1) = 1/2;
        [D2_R(i,i-1),D2_R(i,i+1)] = deal(1);
        D2_R(i,i) = -2;
    end
    S_R = D_R;
    [S_R(1,1),S_R(n_R,n_R)] = deal(3/2);
    [S_R(1,2),S_R(n_R,n_R-1)] = deal(-2);
    [S_R(1,3),S_R(n_R,n_R-2)] = deal(1/2);
    S_R(1,1:n_R) = -1*S_R(1,1:n_R);
    S_R(1,2) = (3 - a_R - 2*(-1+a_R)*S_R(2,1))/a_R;
    S_R(1,1) = -(1+S_R(1,2))/2;
    S_R(1,3) = (1 - S_R(1,2))/2; 
%     S_R(1,1) = (-3+2*(-1+a_R)*S_R(2,1))/(2*a_R);
%     S_R(1,2) = -2*S_R(1,1) - 1;
%     S_R(1,3) = 1 + S_R(1,1); 
%     disp('P=');disp(P);
%     disp('D=');disp(D);       
elseif bndry_order==2
    D_R(1,1) = -24/17;
    D_R(1,2) = 59/34;
    D_R(1,3) = -4/17;
    D_R(1,4) = -3/34;
    D_R(2,1) = -1/2;
    D_R(2,3) = 1/2;
    D_R(3,1) = 4/43;
    D_R(3,2) = -59/86;
    D_R(3,4) = 59/86;
    D_R(3,5) = -4/43;
    D_R(4,1) = 3/98;
    D_R(4,3) = -59/98;
    D_R(4,5) = 32/49;
    D_R(4,6) = -4/49;
%     D(1,1) = -1/2;
%     D(1,2) = 59/96;
%     D(1,3) = -1/12;
%     D(1,4) = -1/32;
%     D(2,1) = -59/96;
%     D(2,3) = 59/96;
%     D(3,1) = 1/12;
%     D(3,2) = -59/96;
%     D(3,4) = 59/96;
%     D(3,5) = -1/12;
%     D(4,1) = 1/32;
%     D(4,3) = -59/96;
%     D(4,5) = 2/3;
%     D(4,6) = -1/12;
    
    [P_R(1,1),P_R(n_R,n_R)] = deal(17/48);
    [P_R(2,2),P_R(n_R-1,n_R-1)] = deal(59/48);
    [P_R(3,3),P_R(n_R-2,n_R-2)] = deal(43/48);
    [P_R(4,4),P_R(n_R-3,n_R-3)] = deal(49/48);

    for i = 5:1:n_R-4
        P_R(i,i) = 1;
        D_R(i,i-2) = 1/12;
        D_R(i,i-1) = -2/3;
        D_R(i,i+1) = 2/3;
        D_R(i,i+2) = -1/12;
    end

    for i=1:1:4
        for j=1:1:6
            D_R(n_R+1-i,n_R+1-j) = -D_R(i,j);
        end
    end

    D2_R(1,1) = 2;
    D2_R(1,2) = -5;
    D2_R(1,3) = 4;
    D2_R(1,4) = -1;
    D2_R(2,1) = 1;
    D2_R(2,2) = -2;
    D2_R(2,3) = 1;
    D2_R(3,1) = -4/43;
    D2_R(3,2) = 59/43;
    D2_R(3,3) = -110/43;
    D2_R(3,4) = 59/43;
    D2_R(3,5) = -4/43;
    D2_R(4,1) = -1/49;
    D2_R(4,3) = 59/49;
    D2_R(4,4) = -118/49;
    D2_R(4,5) = 64/49;
    D2_R(4,6) = -4/49;

    for i = 5:1:n_R-4
        D2_R(i,i-2) = -1/12;
        D2_R(i,i-1) = 4/3;
        D2_R(i,i) = -5/2;
        D2_R(i,i+1) = 4/3;
        D2_R(i,i+2) = -1/12;
    end

    for i=1:1:4
        for j=1:1:6
            D2_R(n_R+1-i,n_R+1-j) = D2_R(i,j);
        end
    end
end
function [P_L,Q_L,P_R,Q_R] = P_Q_matrices(n_L,n_R,space_order)

P_L = zeros(n_L,n_L);
Q_L = zeros(n_L,n_L);

P_R = zeros(n_R,n_R);
Q_R = zeros(n_R,n_R);

if space_order==2
    
    P_L(1,1) = 1/2;
    Q_L(1,1) = -1/2;
    Q_L(1,2) = 1/2;
    Q_L(n_L-1,n_L-2) = -1/2;

    P_L(n_L-1,n_L-1) = 1;
    P_L(n_L,n_L) = 1/2;
    Q_L(n_L-1,n_L) = 1/2;
    Q_L(n_L,n_L-1) = -1/2;
    Q_L(n_L,n_L) = 1/2;

    for i = 2:1:n_L-2
        Q_L(i,i-1) = -1/2;
        Q_L(i,i+1) = 1/2;
        P_L(i,i) = 1;
    end

    beta_R = 1/2;

    P_R(1,1) = beta_R;
    P_R(2,2) = beta_R*2;
    Q_R(1,1) = -beta_R;
    Q_R(1,2) = beta_R;
    Q_R(2,1) = -beta_R;
    Q_R(2,2) = 0;
    Q_R(2,3) = beta_R;

    Q_R(n_R,n_R-1) = -beta_R;
    Q_R(n_R,n_R) = beta_R;
    P_R(n_R,n_R) = beta_R;

    for i = 3:1:n_R-1
        Q_R(i,i-1) = -beta_R;
        Q_R(i,i+1) = beta_R;
        P_R(i,i) = beta_R*2;
    end
    
elseif space_order==3    
    Q_L(1,1) = -1/2;
    Q_L(1,2) = 59/96;
    Q_L(1,3) = -1/12;
    Q_L(1,4) = -1/32;
    Q_L(2,1) = -59/96;
    Q_L(2,3) = 59/96;
    Q_L(3,1) = 1/12;
    Q_L(3,2) = -59/96;
    Q_L(3,4) = 59/96;
    Q_L(3,5) = -1/12;
    Q_L(4,1) = 1/32;
    Q_L(4,3) = -59/96;
    Q_L(4,5) = 2/3;
    Q_L(4,6) = -1/12;
    
    [P_L(1,1),P_L(n_L,n_L)] = deal(17/48);
    [P_L(2,2),P_L(n_L-1,n_L-1)] = deal(59/48);
    [P_L(3,3),P_L(n_L-2,n_L-2)] = deal(43/48);
    [P_L(4,4),P_L(n_L-3,n_L-3)] = deal(49/48);

    for i = 5:1:n_L-4
        P_L(i,i) = 1;
        Q_L(i,i-2) = 1/12;
        Q_L(i,i-1) = -2/3;
        Q_L(i,i+1) = 2/3;
        Q_L(i,i+2) = -1/12;
    end

    for i=1:1:4
        for j=1:1:6
            Q_L(n_L+1-i,n_L+1-j) = -Q_L(i,j);
        end
    end
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
    Q_R(1,1) = -1/2;
    Q_R(1,2) = 59/96;
    Q_R(1,3) = -1/12;
    Q_R(1,4) = -1/32;
    Q_R(2,1) = -59/96;
    Q_R(2,3) = 59/96;
    Q_R(3,1) = 1/12;
    Q_R(3,2) = -59/96;
    Q_R(3,4) = 59/96;
    Q_R(3,5) = -1/12;
    Q_R(4,1) = 1/32;
    Q_R(4,3) = -59/96;
    Q_R(4,5) = 2/3;
    Q_R(4,6) = -1/12;
    
    [P_R(1,1),P_R(n_R,n_R)] = deal(17/48);
    [P_R(2,2),P_R(n_R-1,n_R-1)] = deal(59/48);
    [P_R(3,3),P_R(n_R-2,n_R-2)] = deal(43/48);
    [P_R(4,4),P_R(n_R-3,n_R-3)] = deal(49/48);

    for i = 5:1:n_R-4
        P_R(i,i) = 1;
        Q_R(i,i-2) = 1/12;
        Q_R(i,i-1) = -2/3;
        Q_R(i,i+1) = 2/3;
        Q_R(i,i+2) = -1/12;
    end

    for i=1:1:4
        for j=1:1:6
            Q_R(n_R+1-i,n_R+1-j) = -Q_R(i,j);
        end
    end
    
elseif space_order==4
    Q_L(1,1) = -1/2;
    Q_L(1,2) = 127/211;
    Q_L(1,3) = 35/298;
    Q_L(1,4) = -32/83;
    Q_L(1,5) = 89/456; 
    Q_L(1,6) = -2/69;
    
    Q_L(2,1) = -127/211;
    Q_L(2,3) = -1/167;
    Q_L(2,4) = 391/334;
    Q_L(2,5) = -50/71;
    Q_L(2,6) = 14/99;
    
    Q_L(3,1) = -35/298;
    Q_L(3,2) = 1/167;
    Q_L(3,4) = -34/79;
    Q_L(3,5) = 90/113;
    Q_L(3,6) = -69/271;
    
    Q_L(4,1) = 32/83;
    Q_L(4,2) = -391/334;
    Q_L(4,3) = 34/79;
    Q_L(4,5) = 6/25;
    Q_L(4,6) = 31/316;
    Q_L(4,7) = 1/60;
    
    Q_L(5,1) = -89/456;
    Q_L(5,2) = 50/71;
    Q_L(5,3) = -90/113;
    Q_L(5,4) = -6/25;
    Q_L(5,6) = 37/56;
    Q_L(5,7) = -3/20;
    Q_L(5,8) = 1/60;
    
    Q_L(6,1) = 2/69;
    Q_L(6,2) = -14/99;
    Q_L(6,3) = 69/271;
    Q_L(6,4) = -31/316;
    Q_L(6,5) = -37/56;
    Q_L(6,7) = 3/4;
    Q_L(6,8) = -3/20;
    Q_L(6,9) = 1/60;
    
    [P_L(1,1),P_L(n_L,n_L)] = deal(13649/43200);
    [P_L(2,2),P_L(n_L-1,n_L-1)] = deal(12013/8640);
    [P_L(3,3),P_L(n_L-2,n_L-2)] = deal(2711/4320);
    [P_L(4,4),P_L(n_L-3,n_L-3)] = deal(5359/4320);
    [P_L(5,5),P_L(n_L-4,n_L-4)] = deal(7877/8640);
    [P_L(6,6),P_L(n_L-5,n_L-5)] = deal(43801/43200);

    for i = 7:1:n_L-6
        P_L(i,i) = 1;
        Q_L(i,i-3) = -1/60;
        Q_L(i,i-2) = 3/20;
        Q_L(i,i-1) = -3/4;
        Q_L(i,i+1) = 3/4;
        Q_L(i,i+2) = -3/20;
        Q_L(i,i+3) = 1/60;
    end

    for i=1:1:6
        for j=1:1:9
            Q_L(n_L+1-i,n_L+1-j) = -Q_L(i,j);
        end
    end
    
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    Q_R(1,1) = -1/2;
    Q_R(1,2) = 127/211;
    Q_R(1,3) = 35/298;
    Q_R(1,4) = -32/83;
    Q_R(1,5) = 89/456; 
    Q_R(1,6) = -2/69;
    
    Q_R(2,1) = -127/211;
    Q_R(2,3) = -1/167;
    Q_R(2,4) = 391/334;
    Q_R(2,5) = -50/71;
    Q_R(2,6) = 14/99;
    
    Q_R(3,1) = -35/298;
    Q_R(3,2) = 1/167;
    Q_R(3,4) = -34/79;
    Q_R(3,5) = 90/113;
    Q_R(3,6) = -69/271;
    
    Q_R(4,1) = 32/83;
    Q_R(4,2) = -391/334;
    Q_R(4,3) = 34/79;
    Q_R(4,5) = 6/25;
    Q_R(4,6) = 31/316;
    Q_R(4,7) = 1/60;
    
    Q_R(5,1) = -89/456;
    Q_R(5,2) = 50/71;
    Q_R(5,3) = -90/113;
    Q_R(5,4) = -6/25;
    Q_R(5,6) = 37/56;
    Q_R(5,7) = -3/20;
    Q_R(5,8) = 1/60;
    
    Q_R(6,1) = 2/69;
    Q_R(6,2) = -14/99;
    Q_R(6,3) = 69/271;
    Q_R(6,4) = -31/316;
    Q_R(6,5) = -37/56;
    Q_R(6,7) = 3/4;
    Q_R(6,8) = -3/20;
    Q_R(6,9) = 1/60;
    
    [P_R(1,1),P_R(n_R,n_R)] = deal(13649/43200);
    [P_R(2,2),P_R(n_R-1,n_R-1)] = deal(12013/8640);
    [P_R(3,3),P_R(n_R-2,n_R-2)] = deal(2711/4320);
    [P_R(4,4),P_R(n_R-3,n_R-3)] = deal(5359/4320);
    [P_R(5,5),P_R(n_R-4,n_R-4)] = deal(7877/8640);
    [P_R(6,6),P_R(n_R-5,n_R-5)] = deal(43801/43200);

    for i = 7:1:n_R-6
        P_R(i,i) = 1;
        Q_R(i,i-3) = -1/60;
        Q_R(i,i-2) = 3/20;
        Q_R(i,i-1) = -3/4;
        Q_R(i,i+1) = 3/4;
        Q_R(i,i+2) = -3/20;
        Q_R(i,i+3) = 1/60;
    end

    for i=1:1:6
        for j=1:1:9
            Q_R(n_R+1-i,n_R+1-j) = -Q_R(i,j);
        end
    end

end